<!DOCTYPE html>
            <!DOCTYPE html>
            <html lang="en">
            <head>
                <meta charset="UTF-8">
                <meta name="viewport" content="width=device-width, initial-scale=1.0">
                <title>Attendance</title>
                <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
                <link rel="stylesheet" href="styles.css">
                <script src="script.js" defer></script>
            </head>
            <body>
                <div class="container py-5">
                    <div class="row justify-content-center">
                        <div class="col-md-6">
                            <div class="card shadow">
                                <div class="card-header bg-primary text-white text-center">
                                    <h3>Attendance Marking Form</h3>
                                </div>
                                <div class="card-body">
                                    <form id="attendanceForm">
                                        <div class="mb-3">
                                            <label for="studentName" class="form-label">Student Name</label>
                                            <input type="text" class="form-control" id="studentName" name="studentName" required>
                                        </div>
                                        <div class="mb-3">
                                            <label for="studentId" class="form-label">Student ID</label>
                                            <input type="text" class="form-control" id="studentId" name="studentId" required>
                                        </div>
                                        <div class="mb-3">
                                            <label class="form-label">Attendance Status</label>
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="status" id="present" value="Present" required>
                                                <label class="form-check-label" for="present">Present</label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="status" id="absent" value="Absent">
                                                <label class="form-check-label" for="absent">Absent</label>
                                            </div>
                                            <div class="form-check">
                                                <input class="form-check-input" type="radio" name="status" id="late" value="Late">
                                                <label class="form-check-label" for="late">Late</label>
                                            </div>
                                        </div>
                                        <button type="submit" class="btn btn-success w-100">Mark Attendance</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <script>
                    // This script posts attendance to the backend attendance API.
                    // Assumptions:
                    // - The backend accepts POST /api/attendance with JSON body.
                    // - Body shape: { studentName, studentID, status, date }
                    // If your actual API path or body differ, update `endpoint` and `payload` accordingly.

                    (function () {
                        const endpoint = '/api/attendance'; // <-- change if your API uses a different path
                        const form = document.getElementById('attendanceForm');
                        const submitBtn = form.querySelector('button[type="submit"]');

                        form.addEventListener('submit', async function (e) {
                            e.preventDefault();
                            submitBtn.disabled = true;
                            const originalText = submitBtn.textContent;
                            submitBtn.textContent = 'Submitting...';

                            const studentName = document.getElementById('studentName').value.trim();
                            const studentId = document.getElementById('studentId').value.trim();
                            const status = form.querySelector('input[name="status"]:checked')?.value;

                            if (!studentName || !studentId || !status) {
                                alert('Please complete all fields before submitting.');
                                submitBtn.disabled = false;
                                submitBtn.textContent = originalText;
                                return;
                            }

                            const payload = {
                                studentName,
                                studentID: studentId,
                                status,
                                date: new Date().toISOString()
                            };

                            try {
                                const res = await fetch(endpoint, {
                                    method: 'POST',
                                    headers: { 'Content-Type': 'application/json' },
                                    body: JSON.stringify(payload)
                                });

                                if (res.ok) {
                                    // Try to read response JSON if any, but don't fail if none.
                                    let data = null;
                                    try { data = await res.json(); } catch (err) { /* ignore */ }
                                    alert('Attendance marked successfully.');
                                    form.reset();
                                } else {
                                    let errBody = null;
                                    try { errBody = await res.json(); } catch (err) { /* ignore */ }
                                    const message = (errBody && errBody.message) ? errBody.message : res.statusText || 'Unknown error';
                                    alert('Failed to mark attendance: ' + message);
                                }
                            } catch (err) {
                                alert('Network or server error: ' + err.message);
                            } finally {
                                submitBtn.disabled = false;
                                submitBtn.textContent = originalText;
                            }
                        });
                    })();
                </script>
            </body>
            </html>
